<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ðŸ“š Book Management App</title>
<style>
  /* Root variables for light and dark modes */
  :root {
    --bg-color: rgba(255,255,255,0.85);
    --text-color: #1f2937;
    --card-bg: white;
    --add-btn: #3b82f6;
    --edit-btn: #facc15;
    --delete-btn: #ef4444;
  }

  body.dark-mode {
    --bg-color: rgba(30,30,30,0.85);
    --text-color: #f3f4f6;
    --card-bg: #1f2937;
    --add-btn: #2563eb;
    --edit-btn: #fbbf24;
    --delete-btn: #dc2626;
    background-color: #111827;
  }

  /* Background & body */
  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    margin: 0;
    padding: 0;
    min-height: 100vh;
    background: url('https://images.unsplash.com/photo-1512820790803-83ca734da794?auto=format&fit=crop&w=1350&q=80') no-repeat center center fixed;
    background-size: cover;
    color: var(--text-color);
    transition: background 0.3s, color 0.3s;
  }

  body::before {
    content: "";
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    background-color: var(--bg-color);
    z-index: -1;
    transition: background-color 0.3s;
  }

  h1 {
    text-align: center;
    margin: 20px 0;
    font-size: 2.5rem;
  }

  #toggle-theme {
    display: block;
    margin: 0 auto 20px auto;
    padding: 8px 15px;
    font-size: 16px;
    border-radius: 6px;
    border: none;
    cursor: pointer;
    background-color: var(--add-btn);
    color: white;
    transition: background 0.3s;
  }

  #toggle-theme:hover {
    opacity: 0.8;
  }

  #book-form {
    display: flex;
    justify-content: center;
    flex-wrap: wrap;
    gap: 10px;
    margin-bottom: 30px;
  }

  #book-form input {
    padding: 10px;
    font-size: 16px;
    border-radius: 6px;
    border: 1px solid #cbd5e1;
    flex: 1 1 200px;
    min-width: 150px;
  }

  #book-form button {
  padding: 6px 10px;   /* smaller padding */
  font-size: 14px;     /* smaller text */
  background-color: var(--add-btn);
  color: white;
  border: none;
  border-radius: 6px;
  cursor: pointer;
  transition: background 0.3s;
}

#book-form button:hover {
  opacity: 0.8;
}


  #book-form button:hover {
    opacity: 0.8;
  }

  #books-list {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 20px;
    padding: 0 10px;
  }

  li {
    background: var(--card-bg);
    border-radius: 10px;
    padding: 15px 20px;
    list-style: none;
    width: 250px;
    box-shadow: 0 6px 10px rgba(0,0,0,0.15);
    display: flex;
    flex-direction: column;
    gap: 10px;
    transition: transform 0.2s, background 0.3s;
  }

  li:hover {
    transform: translateY(-3px);
  }

  li span {
    font-size: 16px;
    color: var(--text-color);
  }

  li button {
    padding: 5px 10px;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-size: 14px;
    transition: opacity 0.3s, background 0.3s;
  }

  li button.edit {
    background-color: var(--edit-btn);
    color: white;
  }

  li button.delete {
    background-color: var(--delete-btn);
    color: white;
  }

  /* Modal styles */
  .modal {
    display: none; 
    position: fixed;
    z-index: 10;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    overflow: auto;
    background: rgba(0,0,0,0.5);
  }

  .modal-content {
    background: var(--card-bg);
    margin: 10% auto;
    padding: 20px;
    width: 90%;
    max-width: 350px;
    border-radius: 10px;
    position: relative;
    color: var(--text-color);
  }

  .modal-content input {
    width: 100%;
    padding: 8px;
    margin: 8px 0;
    font-size: 16px;
    border-radius: 6px;
    border: 1px solid #cbd5e1;
    background-color: white;
    color: black;
  }

  body.dark-mode .modal-content input {
    background-color: #374151;
    color: white;
    border: 1px solid #4b5563;
  }

  .modal-content button.save {
    width: 100%;
    padding: 10px;
    font-size: 16px;
    margin-top: 10px;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    background-color: var(--add-btn);
    color: white;
  }

  .modal-content button.save:hover {
    opacity: 0.8;
  }

  .close {
    position: absolute;
    top: 8px;
    right: 12px;
    font-size: 20px;
    font-weight: bold;
    cursor: pointer;
    color: #ef4444;
  }

  @media (max-width: 600px) {
    #books-list {
      flex-direction: column;
      align-items: center;
    }

    li {
      width: 90%;
    }

    #book-form {
      flex-direction: column;
      align-items: center;
    }
  }
</style>
</head>
<body>

<h1>ðŸ“š Book Management App</h1>

<button id="toggle-theme" onclick="toggleTheme()">Toggle Dark Mode</button>

<div id="book-form">
  <input type="text" id="title" placeholder="Book Title">
  <input type="text" id="author" placeholder="Author">
  <button onclick="addBook()">Add Book</button>
</div>

<ul id="books-list"></ul>

<!-- Edit Modal -->
<div id="editModal" class="modal">
  <div class="modal-content">
    <span class="close" onclick="closeModal()">&times;</span>
    <h3>Edit Book</h3>
    <input type="text" id="editTitle" placeholder="Book Title">
    <input type="text" id="editAuthor" placeholder="Author">
    <button class="save" onclick="saveEdit()">Save Changes</button>
  </div>
</div>

<script>
const API_URL = "/books";
let editingBookId = null;

// Dark mode toggle
function toggleTheme() {
  document.body.classList.toggle("dark-mode");
}

// Fetch and display books
async function fetchBooks() {
  const res = await fetch(API_URL);
  const books = await res.json();
  const list = document.getElementById("books-list");
  list.innerHTML = "";
  books.forEach(book => {
    const li = document.createElement("li");
    li.innerHTML = `
      <span><strong>${book.title}</strong><br>by ${book.author}</span>
      <div>
        <button class="edit" onclick="openModal(${book.id}, '${book.title}', '${book.author}')">Edit</button>
        <button class="delete" onclick="deleteBook(${book.id})">Delete</button>
      </div>
    `;
    list.appendChild(li);
  });
}

// Add a new book
async function addBook() {
  const title = document.getElementById("title").value;
  const author = document.getElementById("author").value;
  if (!title || !author) return alert("Enter title and author!");
  await fetch(API_URL, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ title, author })
  });
  document.getElementById("title").value = "";
  document.getElementById("author").value = "";
  fetchBooks();
}

// Delete book
async function deleteBook(id) {
  await fetch(`${API_URL}/${id}`, { method: "DELETE" });
  fetchBooks();
}

// Open edit modal
function openModal(id, title, author) {
  editingBookId = id;
  document.getElementById("editTitle").value = title;
  document.getElementById("editAuthor").value = author;
  document.getElementById("editModal").style.display = "block";
}

// Close modal
function closeModal() {
  document.getElementById("editModal").style.display = "none";
}

// Save changes from modal
async function saveEdit() {
  const newTitle = document.getElementById("editTitle").value;
  const newAuthor = document.getElementById("editAuthor").value;
  if (!newTitle || !newAuthor) return alert("Enter title and author!");
  await fetch(`${API_URL}/${editingBookId}`, {
    method: "PUT",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ title: newTitle, author: newAuthor })
  });
  closeModal();
  fetchBooks();
}

// Close modal if click outside content
window.onclick = function(event) {
  const modal = document.getElementById("editModal");
  if (event.target === modal) closeModal();
}

// Load books on page load
fetchBooks();
</script>

</body>
</html>
